# `Azure`

In Azure, the equivalent of AWS S3 for storing documents is Azure Blob Storage. Azure supports generating “Shared Access Signatures (SAS)” for secure and temporary access to resources in Blob Storage, which works similarly to AWS’s signed URLs.

Here’s a step-by-step guide and code samples to achieve this:




## 1. Set Up Azure Blob Storage
	•	Create a Storage Account in Azure.
	•	Inside the Storage Account, create a Container to store your files.
	•	Ensure that the container’s access level is set to “Private.”


## 2. Generate a SAS Token
In your Node.js backend, you can use the Azure SDK to generate a SAS token for upload/download operations.

     npm install @azure/storage-blob



```js
const { BlobServiceClient, generateBlobSASQueryParameters, ContainerSASPermissions, StorageSharedKeyCredential } = require('@azure/storage-blob');
const { v4: uuidv4 } = require('uuid');

const accountName = "<Your Azure Storage Account Name>";
const accountKey = "<Your Azure Storage Account Key>";
const containerName = "<Your Container Name>";

const credential = new StorageSharedKeyCredential(accountName, accountKey);
const blobServiceClient = new BlobServiceClient(`https://${accountName}.blob.core.windows.net`, credential);

// Function to generate SAS URL
function generateSASUrl(blobName, isDownload = false) {
    const permissions = isDownload ? 'r' : 'cw'; // Read for download, Create/Write for upload
    const expiresOn = new Date(new Date().valueOf() + 3600 * 1000); // 1 hour from now

    const sasParams = generateBlobSASQueryParameters(
        {
            containerName,
            blobName,
            permissions: ContainerSASPermissions.parse(permissions),
            startsOn: new Date(),
            expiresOn,
        },
        credential
    ).toString();

    const sasUrl = `https://${accountName}.blob.core.windows.net/${containerName}/${blobName}?${sasParams}`;
    return sasUrl;
}

// Example usage
const uploadSASUrl = generateSASUrl("example-document.txt", false);
const downloadSASUrl = generateSASUrl("example-document.txt", true);

console.log("Upload SAS URL:", uploadSASUrl);
console.log("Download SAS URL:", downloadSASUrl);
```

## 3. Upload/Download in React

Use the SAS URL generated by the backend for direct interactions with Azure Blob Storage.

React Frontend Code

``Upload File``

```js
async function uploadFile(file, sasUrl) {
    const response = await fetch(sasUrl, {
        method: 'PUT',
        headers: {
            'x-ms-blob-type': 'BlockBlob'
        },
        body: file,
    });

    if (response.ok) {
        console.log('File uploaded successfully');
    } else {
        console.error('Upload failed', response.statusText);
    }
}
```

``Download File``

```js
async function downloadFile(sasUrl) {
    const response = await fetch(sasUrl);
    if (response.ok) {
        const blob = await response.blob();
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = "downloaded-file.txt"; // Change filename as needed
        link.click();
        URL.revokeObjectURL(url);
    } else {
        console.error('Download failed', response.statusText);
    }
}
```

## 4. Useful Resources
    •	Azure Blob Storage Node.js SDK Documentation
	•	Generate SAS Token using Azure SDK
	•	Azure Blob Storage REST API

## 5. Additional Tips

  	• Use environment variables to store sensitive credentials.
	• Consider integrating Azure Managed Identity or Azure Key Vault for enhanced security.
	• For production, configure proper CORS rules in your Azure Storage Account.